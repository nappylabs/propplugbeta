const l=e=>{if(!e||typeof e!="string")return null;const t=e.replace(/[^\d.]/g,""),r=parseFloat(t);return isNaN(r)?null:r},u=e=>e.includes("property24.com")||e.includes("privateproperty.co.za")?"ZAR":e.includes("zoopla.co.uk")||e.includes("rightmove.co.uk")?"GBP":e.includes("realtor.com")||e.includes("zillow.com")?"USD":e.includes("buyrentkenya.com")?"KES":null,i=()=>{const e={price:null,rent:null,levies:null,rates:null},t=document.querySelector(".p24_price");return t&&(e.price=l(t.textContent)),Array.from(document.querySelectorAll(".p24_featureItem")).forEach(n=>{const c=n.querySelector(".p24_label"),o=n.querySelector(".p24_value");if(c&&o){const s=c.textContent.toLowerCase().trim();s.includes("levies")&&(e.levies=l(o.textContent)),s.includes("rates & taxes")&&(e.rates=l(o.textContent))}}),e},a=()=>{const e={price:null,rent:null,levies:null,rates:null},t=document.querySelector(".propertyPrice .price");return t&&(e.price=l(t.textContent)),Array.from(document.querySelectorAll(".prop_features_list li")).forEach(n=>{const c=n.textContent.toLowerCase();c.includes("levies")?e.levies=l(c):c.includes("rates")&&(e.rates=l(c))}),e},p=()=>{const e={price:null,rent:null,levies:null,rates:null},t=document.querySelector('[data-testid="price"]');return t&&(e.price=l(t.textContent)),e},d=()=>{const e={price:null,rent:null,levies:null,rates:null},t=document.querySelector('[data-testid="list-price"]');return t&&(e.price=l(t.textContent)),e},y=()=>{const e={price:null,rent:null,levies:null,rates:null},t=document.querySelector(".price-tag");return t&&(e.price=l(t.textContent)),e};console.log("PropPlug: Scraper loaded.");const f=()=>{const e=window.location.hostname;let t={},r=null;try{e.includes("property24.com")?(t=i(),r="property24"):e.includes("privateproperty.co.za")?(t=a(),r="privateproperty"):e.includes("zoopla.co.uk")?(t=p(),r="zoopla"):e.includes("realtor.com")?(t=d(),r="realtor"):e.includes("buyrentkenya.com")&&(t=y(),r="buyrentkenya")}catch(n){return console.error("PropPlug: Error during scraping",n),{}}return{price:t.price||null,rent:t.rent||null,levies:t.levies||null,rates:t.rates||null,currency:u(e),site:r}};chrome.runtime.onMessage.addListener((e,t,r)=>{if(e.type==="GET_PAGE_DATA"){const n=f();r({success:!0,data:n})}return!0});
